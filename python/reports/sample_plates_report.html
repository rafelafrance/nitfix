<!DOCTYPE html>
<html lang="en">

<head>
<meta charset="utf-8" />
<title>{{title}}</title>

<style>
{% include 'sample_plates_report.css' -%}
</style>
</head>

<body>
  <h1>Nitfix Sample Plates <span>{{ now.strftime('%Y-%m-%d %I:%M %p') }}</span></h1>

  <h2>
    <button data-selector="families" class="toggle closed" title="Open or close this section"></button>
    Family coverage
  </h2>
  <section class="families closed">
    <table>
      <tr class="header">
        <td></td>
        <td>Family</td>
        <td>Genus</td>
        <td>Total count</td>
        <td>Sample count</td>
        <td>Percent covered</td>
      </tr>
      {% for genus in genera %}
        <tr class="closed {{ 'genus' if genus.genus else 'family' }}" data-family="{{ genus.family }}">
          {% if genus.genus %}
            <td></td>
            <td></td>
          {% else %}
            <td><button class="toggle closed" data-family="{{ genus.family }}" title="Open or close this family"></button></td>
            <td class="l">{{ genus.family }}</td>
          {% endif %}
          <td class="l">{{ genus.genus }}</td>
          <td class="r">{{ '{:,}'.format(genus.total) if genus.total else '' }}</td>
          <td class="r">{{ '{:,}'.format(genus.plated) if genus.plated else '' }}</td>
          <td class="r">{{ '{:.2f}'.format(genus.percent) if genus.percent  else '' }}</td>
        </tr>
      {% endfor %}
    </table>
  </section>

  <section class="missing">
    <h2>
      <button data-selector="missing-table" class="closed" title="Open or close this section"></button>
      Samples not in the master taxonomy
    </h2>
    <table class="closed missing-table">
      <tr class="header">
        <td>Plate ID</td>
        <td>Local ID</td>
        <td>Plate row</td>
        <td>Plate column</td>
        <td>Sample ID</td>
      </tr>
      {% for sample in missing %}
        <tr>
          <td class="l">{{ sample.plate_id }}</td>
          <td class="l">{{ sample.local_id }}</td>
          <td>{{ sample.plate_row }}</td>
          <td>{{ sample.plate_col }}</td>
          <td class="l">{{ sample.sample_id }}</td>
        </tr>
      {% endfor %}
    </table>
  </section>

  <section class="plates">
    <h2>
      <button data-selector="plate-toggle" class="" title="Open or close this section"></button>
      Plates
    </h2>
    <div class="sample-search plate-toggle">
      <div class="search-container">
        <label>Filter by scientific name:</label>
        <input  data-selector="scientific-name" class="search" type="text" />
        <button data-selector="scientific-name" class="clear-search" title="Clear search">X</button>
      </div>
      <div class="search-container">
        <label>Filter by sample ID:</label>
        <input  data-selector="sample-id" class="search" type="text" />
        <button data-selector="sample-id" class="clear-search" title="Clear search">X</button>
      </div>
    </div>
      <table class="plate-toggle">
        <tbody></tbody>
      </table>
    <div class="pager-container plate-toggle">
      <button class="first-page" title="First plate">&lt;&lt;</button>
      <button  class="previous-page"title="Previous plate">&lt;</button>
      <label>Plate:</label>
      <input class="pager" type="number" min="1" step="1" value="1"/>
      <label class="max-page"></label>
      <button class="next-page" title="Next plate">&gt;</button>
      <button class="last-page" title="Last plate">&gt;&gt;</button>
    </div>
  </section>

<script>
{% include 'sample_plates_report.js' -%}
</script>

</body>
</html>
