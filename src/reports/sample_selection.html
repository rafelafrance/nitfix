<!DOCTYPE html>
<html lang="en">

<head>
<meta charset="utf-8" />
<title>Sample plate report</title>

<style>
{% include 'sample_selection.css' -%}
</style>

</head>

<body>
  <h1>NitFix Sample Selections <span>{{ now.strftime('%Y-%m-%d %I:%M %p') }}</span></h1>

  <table>
    <thead>
      <tr class="header">
        <th class="thin"></th>
        <th class="l widest">Family Genus</th>
        <th class="r">Species<br/>in Genus</th>
        <th class="r">Sampled</th>
        <th class="r">Sequenced</th>
        <th class="r wider">Automatically<br/>Chosen</th>
        <th class="r">Available<br/>to Choose</th>
        <th class="r wide">Unprocessed<br/>Samples</th>
        <th class="r">Rejected<br/>Samples</th>
        <th class="r">Slots</th>
        <th class="r">Empty<br/>Slots</th>
      </tr>
    </thead>
    <tbody>
      {% for row in species %}
        {% if row.category == '1_header' %}
          <tr class="genus">
            <td class="thin"><button class="toggle closed" data-genus="{{ row.family + ' ' + row.genus}}" title="Open or close this genus"></button></td>
            <td class="l widest">{{row.family}} {{row.genus}}</td>
            <td class="r"><span>{{row.genus_count}}</span></td>
            <td class="r"><span>{{row.samples}}</span></td>
            <td class="r"><span>{{row['2_sequenced'] if row['2_sequenced'] else ''}}</span></td>
            <td class="r wider"><span>{{row['3_chosen'] if row['3_chosen'] else ''}}</span></td>
            <td class="r"><span>{{row['4_available'] if row['4_available'] else ''}}</span></td>
            <td class="r wide"><span>{{row['5_unprocessed'] if row['5_unprocessed'] else ''}}</span></td>
            <td class="r"><span>{{row['6_rejected'] if row['6_rejected'] else ''}}</span></td>
            <td class="r"><span>{{row.slots}}</span></td>
            <td class="r"><span>{{row['empty_slots'] if row['empty_slots'] else ''}}</span></td>
          </tr>
          <tr class="sub-header closed" data-genus="{{ row.family + ' ' + row.genus }}">
            <td class="empty thin"></td>
            <td class="l wide">Scientific Name</td>
            <td class="r">Total DNA (ng)</td>
            <td>Plate</td>
            <td>Well</td>
            <td colspan="4">Sample ID</td>
            <td class="empty"></td>
            <td class="empty"></td>
          </tr>
        {% else %}
          <tr class="{{row.category[2:]}} closed" data-genus="{{ row.family + ' ' + row.genus }}">
            <td class="symbol thin l">
              {% if row.category == '2_sequenced' %}
                <span title="Already sequenced">&check;</span>
              {% elif row.category == '3_chosen' %}
                <span title="Automatically chosen">&oast;</span>
              {% elif row.category == '4_available' %}
                <span title="Available to choose">&oplus;</span>
              {% elif row.category == '5_unprocessed' %}
                <span title="Unprocessed sample">&odot;</span>
              {% elif row.category == '6_rejected' %}
                <span title="Rejected sample">&otimes;</span>
              {% endif %}
            </td>
            <td class="l widest">{{row.scientific_name}}</td>
            <td class="r"><span>{{'' if row.category == '5_unprocessed' else row.total_dna}}</span></td>
            <td>{{row.source_plate}}</td>
            <td>{{row.source_well}}</td>
            <td colspan="4">{{row.sample_id}}</td>
            <td></td>
            <td></td>
          </tr>
        {% endif %}
      {% endfor %}
    </tbody>
  </table>

<script>
{% include 'sample_selection.js' -%}
</script>

</body>
</html>
